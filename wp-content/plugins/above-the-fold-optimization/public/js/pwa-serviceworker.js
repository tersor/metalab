!function(l,m,v){function I(a,d,c){caches.open(q).then(function(b){var f={};d.headers.forEach(function(a,b){f[b]=a});f["x-abtf-sw"]=h();c&&c.max_age&&(f["x-abtf-sw-expire"]=c.max_age);d.blob().then(function(e){e=new Response(e,{status:d.status,statusText:d.statusText,headers:f});b.put(a,e)})})}function F(a){if(a)return"string"==typeof a&&(a=new Request(a,{mode:"no-cors"})),r(a).then(function(d){return d||n(a,{conditions:null})})}function r(a){return caches.open(q).then(function(d){return d.match(a).then(function(a){if(a){var b=
a.headers.get("x-abtf-sw-expire");if(b)var d=a.headers.get("x-abtf-sw");var e=a.headers.get("expire");e&&(e=w(e));b&&d<h()-b?a=!1:e&&e<h()&&(a=!1)}return a})})}function A(a,d){return a=new Request(a),r(a).then(function(a){return a?a.blob().then(function(b){return new Response(b,{status:503,statusText:"Offline",headers:a.headers})}):m(d)["catch"](function(a){throw a;})})}function J(a,d,c,b){var f=c.headers.get("etag"),e=w(c.headers.get("last-modified"));f||e?(c=new Request(a.url,{method:"HEAD",headers:a.headers,
mode:"no-cors"}),m(c).then(function(c){var g=!1,t=c.headers.get("etag");c=w(c.headers.get("last-modified"));return(t&&t!==f?g=!0:c&&c!==e&&(g=!0),g)?(g=n(a,d),b&&(g=g.then(b)),g):null})["catch"](function(){var e=n(a,d);return b&&(e=e.then(b)),e})):(c=n(a,d),b&&(c=c.then(b)))}function n(a,d,c){return m(a).then(function(b){if(b.ok&&400>b.status&&d){var f=!0;d.conditions&&d.conditions.forEach(function(e){if(f)switch(e.type){case "url":e.regex?(g=x(e.pattern))?(c=g.test(a.url),e.not?c&&(f=!1):c||(f=!1)):
f=!1:(c=-1!==a.url.indexOf(e.pattern),e.not?c&&(f=!1):c||(f=!1));break;case "header":var d=b.headers.get(e.name);if(d)if(e.regex){var g=x(e.pattern);g?(c=g.test(d),e.not?c&&(f=!1):c||(f=!1)):f=!1}else if("object"==typeof e.pattern)if(e.pattern.operator)if(d=parseFloat(d),g=parseFloat(e.pattern.value),isNaN(d)||isNaN(g))f=!1;else{switch(e.pattern.operator){case "<":c=d<g;break;case ">":c=d>g;break;case "=":var c=d===g;break;default:f=!1}f&&(e.not?c&&(f=!1):c||(f=!1))}else f=!1;else-1===d.indexOf(e.pattern)&&
(f=!1);else f=!1}});f&&I(a,b.clone(),d)}return b})["catch"](function(b){return c?c(a,null,b):null})}function G(){B||(!C||C<h()-10)&&(B=!0,C=h(),caches.keys().then(function(a){return a&&0!==a.length?Promise.all(a.map(function(a){if(0!==a.indexOf(q))return caches["delete"](a);caches.open(a).then(function(a){a.keys().then(function(b){if(!(b.length<y)){var d=[],e=[],c=[];return b.forEach(function(b){e.push(b);c.push(a.match(b))}),Promise.all(c).then(function(b){var c=h();b.forEach(function(b,g){if(b&&
b.headers){var f=b.headers.get("x-abtf-sw");if(f){var t=b.headers.get("x-abtf-sw-expire");if(t&&f&&f<h()-t)return void a["delete"](e[g])}else f=c;!1!==d&&d.push({t:f,r:e[g]})}});d&&d.length>y&&(d.sort(function(a,b){return a.t>b.t?-1:a.t<b.t?1:0}),d.slice(y).forEach(function(b){a["delete"](b.r)}))})}})})})).then(function(){B=!1}):Promise.resolve()}))}function x(a){if(a=a.match(K)){try{var d=new RegExp(a[1],a[2])}catch(c){}return d||!1}}function w(a){if(a)return isNaN(parseInt(a))?(a=Date.parse(a),
isNaN(a)?void 0:Math.round(a/1E3)):a}function h(){return Math.round(Date.now()/1E3)}function z(){return p?Promise.resolve():(p=!0,m("./abtf-pwa-config.json?"+Math.round(Date.now()/1E3),{mode:"no-cors"}).then(function(a){if(p=!1,a&&a.ok&&400>a.status)return a.json().then(function(a){if(a){a instanceof Array&&(a={policy:a});a.policy&&(k=a.policy,u=h());var c=[];a.start_url&&c.push(a.start_url);a.policy&&a.policy.forEach(function(a){a.offline&&-1===c.indexOf(a.offline)&&c.push(a.offline)});a.preload&&
a.preload.forEach(function(a){-1===c.indexOf(a)&&c.push(a)});preloadPromises=[];c.forEach(function(a){preloadPromises.push(F(a))})}});throw k=!1,Error("service worker config not found: ./abtf-pwa-config.json");})["catch"](function(a){k=p=!1;setTimeout(function(){throw a;})}))}function H(a){(new Promise(function(d){if(!k||!u||a&&a>u){var c=!k;z().then(function(){c&&d(k?k:!1)})["catch"](function(){c&&d(!1)})}else if(!p&&u<h()-300){p=!0;var b=new Request("./abtf-pwa-config.json?"+Math.round(Date.now()/
1E3),{method:"HEAD",mode:"no-cors"});m(b).then(function(a){p=!1;var b=!0;a&&a.ok&&(a=w(a.headers.get("last-modified")))&&a<=u&&(b=!1);b&&z()})["catch"](function(){p=!1;z()})}else d(k)}))["catch"](function(a){setTimeout(function(){throw a;})})}var q,k=!1,u=!1,y=1E3;v.prototype.add||(v.prototype.add=function(a){return this.addAll([a])});v.prototype.addAll||(v.prototype.addAll=function(a){function d(a){this.name="NetworkError";this.code=19;this.message=a}var c=this;return d.prototype=Object.create(Error.prototype),
Promise.resolve().then(function(){if(1>arguments.length)throw new TypeError;return a=a.map(function(a){return a instanceof Request?a:String(a)}),Promise.all(a.map(function(a){"string"==typeof a&&(a=new Request(a));var b=(new URL(a.url)).protocol;if("http:"!==b&&"https:"!==b)throw new d("Invalid scheme");return m(a.clone())["catch"](function(a){throw a;})}))}).then(function(b){return Promise.all(b.map(function(b,e){return c.put(a[e],b)}))}).then(function(){})});CacheStorage.prototype.match||(CacheStorage.prototype.match=
function(a,d){var c=this;return this.keys().then(function(b){var f;return b.reduce(function(b,E){return b.then(function(){return f||c.open(E).then(function(b){return b.match(a,d)}).then(function(a){return f=a})})},Promise.resolve())})});l.addEventListener("install",function(a){a.waitUntil(z().then(function(){l.skipWaiting()})["catch"](function(){l.skipWaiting()}))});l.addEventListener("activate",function(a){a.waitUntil(l.clients.claim())});var p,D,K=/^\/(.*)\/([gimuy]+)?$/,C=!1,B=!1;l.addEventListener("fetch",
function(a){if("GET"===a.request.method){var d=!1;if(["wp-admin/","wp-login.php"].forEach(function(b){d||(b=new RegExp("^([^/]+)?//"+l.location.host+"(:[0-9]+)?/"+b),(b.test(a.request.url)||a.request.referrer&&b.test(a.request.referrer))&&(d=!0))}),!(d||a.request.url.match(/\&preview=true/)||a.request.url.match(/\&preview_nonce=/))&&(H(),k&&q)){var c=function(a,c){if(!c||0===c.length)return!1;if(D)try{clearTimeout(D)}catch(E){}D=setTimeout(G,500);var b=!1;if(c.forEach(function(c){if(!b&&c.match&&
0!==c.match.length){var d=!0;c.match.forEach(function(b){if(d)switch(b.type){case "url":if(b.regex)(f=x(b.pattern))?(g=f.test(a.request.url),b.not?g&&(d=!1):g||(d=!1)):d=!1;else if(b.pattern instanceof Array){var c=!1;b.pattern.forEach(function(b){c||-1!==a.request.url.indexOf(b)&&(c=!0)});b.not?c&&(d=!1):c||(d=!1)}else g=-1!==a.request.url.indexOf(b.pattern),b.not?g&&(d=!1):g||(d=!1);break;case "header":switch(b.name.toLowerCase()){case "referer":case "referrer":e=a.request.referrer;break;default:var e=
a.request.headers.get(b.name)}if(e)if(b.regex){var f=x(b.pattern);f?(g=f.test(e),b.not?g&&(d=!1):g||(d=!1)):d=!1}else{var g=-1!==e.indexOf(b.pattern);b.not?g&&(d=!1):g||(d=!1)}else b.not||(d=!1)}});d&&(b=c)}}),!b)return!1;switch(b.strategy){case "never":return!1;case "cache":return r(a.request).then(function(c){if(c){var d=!0,e=b.cache.update_interval?!isNaN(parseInt(b.cache.update_interval))&&parseInt(b.cache.update_interval):!1;if(e){var f=c.headers.get("x-abtf-sw");f&&parseInt(f)>h()-e&&(d=!1)}return d&&
function(a,c){setTimeout(function(){var d;if(b.cache.head_update&&(d=function(){clients.matchAll().then(function(b){b.forEach(function(b){b.postMessage([2,a.url])})})}),b.cache.head_update)J(a,b.cache,c,d);else{var e=n(a,b.cache);d&&e.then(d)}},10)}(a.request.clone(),c.clone()),c}return n(a.request,b.cache,function(c,d){return b.offline?A(b.offline,c.clone()):d||m(a.request.clone())["catch"](function(a){throw a;})})});case "event":return r(a.request).then(function(c){return c||n(a.request,null,function(c,
d){return b.offline?A(b.offline,c.clone()):d||m(a.request)["catch"](function(a){throw a;})})});default:return n(a.request,b.cache,function(c,d){return r(c).then(function(e){return e||(b.offline?A(b.offline,c.clone()):d||m(a.request)["catch"](function(a){throw a;}))})})}}(a,k);if(!1!==c)return a.respondWith(c)}}});l.addEventListener("message",function(a){if(a&&a.data&&a.data instanceof Array){if(1===a.data[0]){a.data[1]&&!isNaN(parseInt(a.data[1]))&&H(parseInt(a.data[1]));a.data[3]&&!isNaN(parseInt(a.data[3]))&&
(y=parseInt(a.data[3]));var d="abtf:"+(a.data[2]?a.data[2]+":":"");d!==q&&(q=d);G()}if(2===a.data[0]||3===a.data[0])var c=a.ports[0]?function(b,c){a.ports[0].postMessage({error:b,status:c})}:!1;if(2===a.data[0])if(a.data[1]){var b;if("string"==typeof a.data[1]||a.data[1]instanceof Request?b=[a.data[1]]:a.data[1]instanceof Array&&(b=a.data[1]),b){var f=[];b.forEach(function(a){f.push(F(a))});c&&Promise.all(f).then(function(a){var b=[];a.forEach(function(a){var c={url:a.url,status:a.status,statusText:a.statusText};
a=a.headers.get("content-length");c.size=isNaN(parseInt(a))?-1:parseInt(a);b.push(c)});c(null,b)})["catch"](function(){})}else c&&c("invalid-data")}else c&&c("no-urls");3===a.data[0]&&(l.registration.showNotification(a.data[1],a.data[2]),c&&c(null,"sent"))}})}(self,self.fetch,Cache);
